<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="fr"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AdminController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JoParis2024</a> &gt; <a href="index.source.html" class="el_package">com.pchab.JoParis2024.controller</a> &gt; <span class="el_source">AdminController.java</span></div><h1>AdminController.java</h1><pre class="source lang-java linenums">package com.pchab.JoParis2024.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestHeader;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.pchab.JoParis2024.pojo.Event;
import com.pchab.JoParis2024.security.payload.request.NewEventRequest;
import com.pchab.JoParis2024.security.payload.request.PutEventRequest;
import com.pchab.JoParis2024.security.payload.response.EventAdminResponse;
import com.pchab.JoParis2024.service.EventService;
import com.pchab.JoParis2024.service.TicketService;

import io.swagger.v3.oas.annotations.Operation;
import io.swagger.v3.oas.annotations.tags.Tag;
import jakarta.validation.Valid;


@RestController
@RequestMapping(&quot;/admin&quot;)
@Tag(name=&quot;Admin&quot;, description=&quot;Endpoints for admin operations&quot;)
<span class="fc" id="L30">public class AdminController {</span>

    @Autowired
    private EventService eventService;

    @Autowired
    private TicketService ticketService;

    @GetMapping(&quot;/events&quot;)
    @Operation(summary = &quot;Get all events (admin)&quot;, description = &quot;Retrieve a list of all events with admin details&quot;)
    public ResponseEntity&lt;List&lt;EventAdminResponse&gt;&gt; getAllEvents(@RequestHeader(value = &quot;Authorization&quot;, required = true) String authorizationHeader) {

<span class="fc" id="L42">        List&lt;EventAdminResponse&gt; events = eventService.getAllEventsAdmin();</span>
       
<span class="fc" id="L44">        return ResponseEntity.ok(events);</span>
    }

    @PostMapping(&quot;/createEvent&quot;)
    @Operation(summary = &quot;Create a new event&quot;, description = &quot;Create a new event with the provided details&quot;)
    public ResponseEntity&lt;String&gt; createEvent(@RequestHeader(value = &quot;Authorization&quot;, required = true) String authorizationHeader,@Valid @RequestBody NewEventRequest newEventRequest) {

<span class="fc" id="L51">        Event event = new Event();</span>
<span class="fc" id="L52">        event.setTitle(newEventRequest.getEventTitle());</span>
<span class="fc" id="L53">        event.setDescription(newEventRequest.getEventDescription());</span>
<span class="fc" id="L54">        event.setDate(newEventRequest.getEventDate());</span>
<span class="fc" id="L55">        event.setSport(newEventRequest.getEventSport());</span>
<span class="fc" id="L56">        event.setCity(newEventRequest.getEventCity());</span>
<span class="fc" id="L57">        event.setCapacity(newEventRequest.getEventCapacity());</span>
<span class="fc" id="L58">        event.setPrice(newEventRequest.getEventPrice());</span>
<span class="fc" id="L59">        event.setStadium(newEventRequest.getEventStadium());</span>

<span class="fc" id="L61">        System.out.println(&quot;---- ***************** Creating new event ----&quot;);</span>
/*
        if (newEventRequest == null) {
            System.out.println(&quot;NewEventRequest is null!&quot;);
        } else {
            System.out.println(&quot;NewEventRequest is not null.&quot;);
        }

        System.out.println(&quot;Received new event creation request: &quot; + newEventRequest);
        System.out.println(&quot;Title: &quot; + newEventRequest.getEventTitle());
        System.out.println(&quot;Description: &quot; + newEventRequest.getEventDescription());
        System.out.println(&quot;Date: &quot; + newEventRequest.getEventDate());
        System.out.println(&quot;Sport: &quot; + newEventRequest.getEventSport());
        System.out.println(&quot;City: &quot; + newEventRequest.getEventCity());
        System.out.println(&quot;Capacity: &quot; + newEventRequest.getEventCapacity());
        System.out.println(&quot;Price: &quot; + newEventRequest.getEventPrice());
        System.out.println(&quot;Stadium: &quot; + newEventRequest.getEventStadium());
*/

<span class="fc" id="L80">        Event createdEvent = eventService.createEvent(event);</span>

        //System.out.println(&quot;--- Event created: &quot; + createdEvent);

<span class="fc" id="L84">        return ResponseEntity.ok(&quot;Event created successfully with ID: &quot; + createdEvent.getId());</span>
    }

    @PutMapping(&quot;/updateEvent&quot;)
    @Operation(summary = &quot;Update an existing event&quot;, description = &quot;Update an existing event with the provided details&quot;)
    public ResponseEntity&lt;?&gt; updateEvent(@RequestHeader(value = &quot;Authorization&quot;, required = true) String authorizationHeader,@Valid @RequestBody PutEventRequest putEventRequest) {
        
        /*
        System.out.println(&quot;Received event update request: &quot; + putEventRequest);
        System.out.println(&quot;ID: &quot; + putEventRequest.getEventId());
        System.out.println(&quot;Title: &quot; + putEventRequest.getEventTitle());
        System.out.println(&quot;Description: &quot; + putEventRequest.getEventDescription());
        System.out.println(&quot;Date: &quot; + putEventRequest.getEventDate());
        System.out.println(&quot;Sport: &quot; + putEventRequest.getEventSport());
        System.out.println(&quot;City: &quot; + putEventRequest.getEventCity());
        System.out.println(&quot;Capacity: &quot; + putEventRequest.getEventCapacity());
        System.out.println(&quot;Price: &quot; + putEventRequest.getEventPrice());
        System.out.println(&quot;Stadium: &quot; + putEventRequest.getEventStadium());
     */   
<span class="fc" id="L103">        Event event = new Event();</span>
<span class="fc" id="L104">        event.setId(putEventRequest.getEventId());</span>
<span class="fc" id="L105">        event.setTitle(putEventRequest.getEventTitle());</span>
<span class="fc" id="L106">        event.setDescription(putEventRequest.getEventDescription());</span>
<span class="fc" id="L107">        event.setDate(putEventRequest.getEventDate());</span>
<span class="fc" id="L108">        event.setSport(putEventRequest.getEventSport());</span>
<span class="fc" id="L109">        event.setCity(putEventRequest.getEventCity());</span>
<span class="fc" id="L110">        event.setCapacity(putEventRequest.getEventCapacity());</span>
<span class="fc" id="L111">        event.setPrice(putEventRequest.getEventPrice());</span>
<span class="fc" id="L112">        event.setStadium(putEventRequest.getEventStadium());</span>

        /* Sauvegarde des modifications */
<span class="fc" id="L115">        Event updatedEvent = eventService.updateEvent(event, event.getId());</span>
        //System.out.println(&quot;--- Event updated: &quot; + updatedEvent);
<span class="fc" id="L117">        return ResponseEntity.ok().body(&quot;Epreuve mise à jour avec succès !&quot;);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.13.202504020838</span></div></body></html>